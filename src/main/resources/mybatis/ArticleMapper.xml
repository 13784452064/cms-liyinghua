<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.liyinghua.dao.ArticleMapper">
	<resultMap type="com.liyinghua.entity.Article" id="articleMap">
			<id column="id" property="id"/>
			<result column=" title" property="title"/>
			<result column=" content" property="content"/>
			<result column=" picture" property="picture"/>
			<result column=" channel_id" property="channelId"/>
			<result column=" category_id" property="categoryId"/>
			<result column=" user_id" property="userId"/>
			<result column=" created" property="created"/>
			<result column=" hits" property="hits"/>
			<result column=" hot" property="hot"/>
			<result column=" status" property="status"/>
			<result column=" deleted" property="deleted"/>
			<result column=" updated" property="updated"/>
			<result column=" commentCnt" property="commentCnt"/>
			<result column=" articleType" property="articleType"/>
			<association property="user" column="user_id" select="com.liyinghua.dao.UserMapper.getUserById"></association> 
			<association property="channel" column="channel_id" select="com.liyinghua.dao.ChannelMapper.findById"></association> 
			<association property="category" column="category_id" select="com.liyinghua.dao.CategoryMapper.findById"></association>     
	</resultMap>                
	<select id="getArticleByChannelId" resultMap="articleMap">
		select a.*,b.username,b.id as uid from cms_article a left join cms_user b on a.user_id=b.id
		 <where>
		 	<if test="channelId!=null and channelId!=''">
		 		a.channel_id=#{channelId}
		 	</if>
		 </where> and a.deleted=0 and a.status=1 Limit 10;
	</select> 
	<select id="getArticleBychannelIdAndByCategoryId" resultMap="articleMap">
		select a.*,b.username,b.id as uid from cms_article a left join cms_user b on a.user_id=b.id
		 <where>
		 	<if test="channelId!=null and channelId!=''">
		 		a.channel_id=#{channelId}
		 	</if>
		 	<if test="categoryId!=null and categoryId!=''">
		 		and a.category_id=#{categoryId}
		 	</if>
		 </where> and a.deleted=0 and a.status=1  Limit 10 ;
	</select>   
	<select id="getArticleById" resultMap="articleMap">
		select a.*,b.username,b.id as uid from cms_article a left join cms_user b on a.user_id=b.id where a.id=#{articleId}
	</select>            
</mapper>